<!-- Modal T·∫°o/S·ª≠a M·ª•c ti√™u Ti·∫øt ki·ªám -->
<div class="modal fade" id="goalModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="goalModalTitle">
          T·∫°o m·ª•c ti√™u ti·∫øt ki·ªám m·ªõi
        </h5>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="ƒê√≥ng"
        ></button>
      </div>

      <div class="modal-body">
        <form id="goalForm">
          <input type="hidden" name="id" />

          <div class="mb-3">
            <label class="form-label"
              >Ti√™u ƒë·ªÅ m·ª•c ti√™u <span class="text-danger">*</span></label
            >
            <input
              type="text"
              class="form-control"
              name="name"
              placeholder="vd. Qu·ªπ kh·∫©n c·∫•p"
              required
            />
          </div>

          <div class="mb-3">
            <label class="form-label">M√¥ t·∫£</label>
            <input
              type="text"
              class="form-control"
              name="description"
              placeholder="vd. 3 th√°ng chi ph√≠ d·ª± ph√≤ng"
            />
          </div>

          <div class="row">
            <div class="col-md-6 mb-3">
              <label class="form-label">S·ªë ti·ªÅn m·ª•c ti√™u <span class="text-danger">*</label>
              <input
                type="number"
                class="form-control"
                name="target_amount"
                min="0"
                step="1000"
                required
              />
            </div>
            <div class="col-md-6 mb-3">
              <label class="form-label">ƒê√£ ti·∫øt ki·ªám</label>
              <input
                type="number"
                class="form-control"
                name="current_amount"
                min="0"
                step="1000"
                value="0"
              />
            </div>
          </div>

          <div class="row">
            <div class="col-md-6 mb-3">
              <label class="form-label">Danh m·ª•c <span class="text-danger">*</label>
              <select class="form-select" name="category">
                <option value="">Ch·ªçn danh m·ª•c</option>
                <option value="emergency">Kh·∫©n c·∫•p</option>
                <option value="tech">ƒê·ªì c√¥ng ngh·ªá</option>
                <option value="travel">Du l·ªãch</option>
                <option value="gift">Qu√† t·∫∑ng</option>
                <option value="housing">Nh√† ·ªü</option>
                <option value="transportation">Di chuy·ªÉn</option>
                <option value="personal">C√° nh√¢n</option>
                <option value="other">Kh√°c</option>
              </select>
            </div>
            <div class="col-md-6 mb-3">
              <label class="form-label">M·ª©c ƒë·ªô ∆∞u ti√™n</label>
              <select class="form-select" name="priority">
                <option value="" selected>Ch·ªçn m·ª©c ƒë·ªô ∆∞u ti√™n</option>
                <option value="low">Th·∫•p</option>
                <option value="medium">Trung b√¨nh</option>
                <option value="high">Cao</option>
              </select>
            </div>
          </div>

          <div class="row">
            <div class="col-md-6 mb-3">
              <label class="form-label">Ng√†y ho√†n th√†nh <span class="text-danger">*</span></label>
              <input type="date" class="form-control" name="deadline" />
            </div>
            <div class="col-md-6 mb-0">
              <label class="form-label">ƒê√≥ng g√≥p h√†ng th√°ng <span class="text-danger">*</label>
              <input
                type="number"
                class="form-control"
                name="monthly_contribution"
                min="0"
                value="0"
              />
            </div>
          </div>
        </form>
      </div>

      <div class="modal-footer">
        <button class="btn btn-light" data-bs-dismiss="modal">H·ªßy</button>
        <button class="btn btn-primary" type="submit" form="goalForm">
          L∆∞u
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Ch·ªâ form.html x·ª≠ l√Ω ‚Äúicon cho danh m·ª•c‚Äù ƒë·ªÉ t√°ch bi·ªát v·ªõi trang ch√≠nh -->
<script>
  (() => {
    // B·∫£n ƒë·ªì gi√° tr·ªã -> icon + nh√£n
    const CAT_META = {
      emergency: { icon: "üßØ", label: "Kh·∫©n c·∫•p" },
      tech: { icon: "üíª", label: "ƒê·ªì c√¥ng ngh·ªá" },
      travel: { icon: "‚úàÔ∏è", label: "Du l·ªãch" },
      gift: { icon: "üéÅ", label: "Qu√† t·∫∑ng" },
      housing: { icon: "üè†", label: "Nh√† ·ªü" },
      transportation: { icon: "üöå", label: "Di chuy·ªÉn" },
      personal: { icon: "üßë", label: "C√° nh√¢n" },
      other: { icon: "üîñ", label: "Kh√°c" },
    };

    const modal = document.getElementById("goalModal");

    function decorateCategorySelect() {
      const sel = modal?.querySelector('select[name="category"]');
      if (!sel) return;
      [...sel.options].forEach((op) => {
        if (!op.value) {
          op.textContent = "Ch·ªçn danh m·ª•c";
          return;
        }
        const meta = CAT_META[op.value];
        if (meta) op.textContent = `${meta.icon} ${meta.label}`;
      });
    }

    // Trang ƒëi·ªÉm m·ªói khi modal m·ªü (v√† m·ªôt l·∫ßn khi trang ƒë√£ load)
    modal?.addEventListener("shown.bs.modal", decorateCategorySelect);
    if (document.readyState !== "loading") decorateCategorySelect();
    else document.addEventListener("DOMContentLoaded", decorateCategorySelect);
  })();
</script>
